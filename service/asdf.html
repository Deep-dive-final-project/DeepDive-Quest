html
<html>
<head>
    <meta charset="UTF-8">
    <style>
        p {
            display: block;
        }
    </style>
</head>
<body>
<h2>강의 목적</h2>
<ul>
    <li>JPA의 내부 동작을 이해하기 위해 영속성 컨텍스트를 이해하는 것</li>
    <li>JPA의 엔티티 매니저와 엔티티 매니저 팩토리의 역할과 기능을 이해하는 것</li>
</ul>

<h2>용어 정리</h2>
<ul>
    <li>EntityManagerFactory : 고객의 요청이 올 때마다 EntityManager를 생성</li>
    <li>EntityManager : 커넥션을 이용해 DB를 사용</li>
    <li>영속성 컨텍스트 : 엔티티를 영구 저장하는 환경</li>
    <li>비영속 : 영속성 컨텍스트와 관계가 없는 새로운 상태</li>
    <li>영속 : 영속성 컨텍스트에 관리되는 상태</li>
    <li>준영속 : 영속성 컨텍스트에 저장되었다가 분리된 상태</li>
    <li>삭제 : 삭제된 상태</li>
</ul>

<h2>본문요약</h2>
<h3>영속성 컨텍스트</h3>
<p>
    JPA를 이해하기 위해서는 영속성 컨텍스트를 이해해야 한다. 영속성 컨텍스트는 엔티티를 영구 저장하는 환경을 의미하며,
    이는 논리적인 개념으로 눈에 보이지 않는다. 엔티티 매니저를 통해 영속성 컨텍스트에 접근하며,
    엔티티 매니저가 생성될 때 1:1로 영속성 컨텍스트가 만들어진다.
</p>
<p>
    예를 들어, EntityManager.persist(entity)를 호출할 때, 이는 사실 DB에 저장하는 것이 아니라
    영속성 컨텍스트에 엔티티를 저장하는 것이다.
</p>

<h3>엔티티의 생명주기</h3>
<p>
    엔티티는 비영속, 영속, 준영속, 삭제 네 가지 상태를 가지며, 각각의 상태는 다음과 같다:
</p>
<ul>
    <li>비영속 (new/transient): new를 이용해 생성한 객체로 영속성 컨텍스트와 관계 없는 상태</li>
    <li>영속 (managed): 영속성 컨텍스트에 관리되는 상태</li>
    <li>준영속 (detached): 영속성 컨텍스트에 저장되었다가 분리된 상태</li>
    <li>삭제 (removed): 삭제된 상태</li>
</ul>
<p>
    예를 들어, 아래와 같은 코드에서 객체를 생성하고 영속성 컨텍스트와 관계가 없는 상태를 비영속이라고 한다:
</p>
<code>
    Member member = new Member();
    member.setId("member1");
    member.setUsername("회원1");
</code>

<p>
    반면, 아래와 같은 코드를 통해 영속성 컨텍스트에 엔티티를 추가하면 영속 상태가 된다:
</p>
<code>
    EntityManager em = emf.createEntityManager();
    em.getTransaction().begin();
    em.persist(member);
</code>

<p>
    준영속과 삭제 상태는 다음과 같이 나타낼 수 있다:
</p>
<code>
    em.detach(member); // 회원 엔티티를 영속성 컨텍스트에서 분리, 준영속 상태
    em.remove(member); // 객체를 삭제한 상태 (삭제)
</code>

<h3>영속성 컨텍스트의 이점</h3>
<p>
    영속성 컨텍스트는 애플리케이션과 DB 사이에 중간 계층을 두어 다양한 이점을 제공한다.
    이점에는 1차 캐시, 동일성(identity) 보장, 트랜잭션을 지원하는 쓰기 지연 (Transactional write-behind),
    변경 감지 (Dirty Checking), 지연 로딩 (Lazy Loading) 등이 있다.
</p>

<h2>결론</h2>
<ul>
    <li>영속성 컨텍스트는 JPA의 핵심 개념이다.</li>
    <li>엔티티 매니저와 영속성 컨텍스트는 1:1 관계이다.</li>
    <li>엔티티는 비영속, 영속, 준영속, 삭제 상태를 가진다.</li>
    <li>영속성 컨텍스트는 다양한 이점을 제공한다.</li>
</ul>

<h2>관련 레퍼런스</h2>
<ul>
    <li><a href="https://docs.oracle.com/javaee/7/tutorial/persistence-intro.htm">Oracle 공식 문서</a></li>
    <li><a href="https://search.kyobobook.co.kr/search?keyword=자바%20ORM%20표준%20JPA%20프로그래밍">자바 ORM 표준 JPA 프로그래밍</a></li>
</ul>

</body>
</html>